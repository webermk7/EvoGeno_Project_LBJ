NEON_MAGs_metagenomes_chemistry_CLBJ <- NEON_MAGs_metagenomes_chemistry %>%
filter(`Site ID.x` == "CLBJ") %>%
filter(Domain == "Bacteria")
CLBJ_MAGs_label <- NEON_MAGs_metagenomes_chemistry_CLBJ$label
tree_bac_CLBJ_MAGs <-drop.tip(tree_bac,tree_bac$tip.label[-match(CLBJ_MAGs_label, tree_bac$tip.label)])
ggtree(tree_bac_CLBJ_MAGs, layout="circular")  %<+%
NEON_MAGs_metagenomes_chemistry +
geom_point(mapping=aes(color=Phylum))
NEON_MAGs_metagenomes_chemistry_CLBJ <- NEON_MAGs_metagenomes_chemistry %>%
filter(`Site ID.x` == "CLBJ")
NEON_MAGs_metagenomes_chemistry_CLBJ <- NEON_MAGs_metagenomes_chemistry %>%
filter(`Site ID.x` == "CLBJ") %>%
filter(Domain == "Bacteria") %>%
filter(Phylum == "Actinomycetota")
CLBJ_MAGs_label <- NEON_MAGs_metagenomes_chemistry_CLBJ$label
tree_bac_CLBJ_MAGs_Actino <-drop.tip(tree_bac,tree_bac$tip.label[-match(CLBJ_MAGs_label, tree_bac$tip.label)])
ggtree(tree_bac_CLBJ_MAGs_Actino, layout="circular")  %<+%
NEON_MAGs_metagenomes_chemistry +
geom_point(mapping=aes(color=Order))
library(tidyverse)
library(plotly)
library(knitr)
library(DT)
library(readr)
library(ggtree)
library(treeio)
library(ggimage)
library(rphylopic)
NEON_MAGs <- read_csv("data/GOLD_Study_ID_Gs0161344_NEON_2024_4_21.csv") %>%
# remove columns that are not needed for data analysis
select(-c(`GOLD Study ID`, `Bin Methods`, `Created By`, `Date Added`, `Bin Lineage`)) %>%
# create a new column with the Assembly Type
mutate("Assembly Type" = case_when(`Genome Name` == "NEON combined assembly" ~ `Genome Name`,
TRUE ~ "Individual")) %>%
mutate_at("Assembly Type", str_replace, "NEON combined assembly", "Combined") %>%
mutate_at("GTDB-Tk Taxonomy Lineage", str_replace, "d__", "") %>%
mutate_at("GTDB-Tk Taxonomy Lineage", str_replace, "p__", "") %>%
mutate_at("GTDB-Tk Taxonomy Lineage", str_replace, "c__", "") %>%
mutate_at("GTDB-Tk Taxonomy Lineage", str_replace, "o__", "") %>%
mutate_at("GTDB-Tk Taxonomy Lineage", str_replace, "f__", "") %>%
mutate_at("GTDB-Tk Taxonomy Lineage", str_replace, "g__", "") %>%
mutate_at("GTDB-Tk Taxonomy Lineage", str_replace, "s__", "") %>%
separate(`GTDB-Tk Taxonomy Lineage`, c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species"), ";", remove = FALSE) %>%
mutate_at("Domain", na_if,"") %>%
mutate_at("Phylum", na_if,"") %>%
mutate_at("Class", na_if,"") %>%
mutate_at("Order", na_if,"") %>%
mutate_at("Family", na_if,"") %>%
mutate_at("Genus", na_if,"") %>%
mutate_at("Species", na_if,"") %>%
# Get rid of the the common string "Soil microbial communities from "
mutate_at("Genome Name", str_replace, "Terrestrial soil microbial communities from ", "") %>%
# Use the first `-` to split the column in two
separate(`Genome Name`, c("Site","Sample Name"), " - ") %>%
# Get rid of the the common string "S-comp-1"
mutate_at("Sample Name", str_replace, "-comp-1", "") %>%
# separate the Sample Name into Site ID and plot info
separate(`Sample Name`, c("Site ID","subplot.layer.date"), "_", remove = FALSE,) %>%
# separate the plot info into 3 columns
separate(`subplot.layer.date`, c("Subplot", "Layer", "Date"), "-")
NEON_metagenomes <- read_tsv("data/exported_img_data.tsv") %>%
rename(`Genome Name` = `Genome Name / Sample Name`) %>%
filter(str_detect(`Genome Name`, 're-annotation', negate = T)) %>%
filter(str_detect(`Genome Name`, 'WREF plot', negate = T))
NEON_metagenomes <- NEON_metagenomes %>%
# Get rid of the the common string "Soil microbial communities from "
mutate_at("Genome Name", str_replace, "Terrestrial soil microbial communities from ", "") %>%
# Use the first `-` to split the column in two
separate(`Genome Name`, c("Site","Sample Name"), " - ") %>%
# Get rid of the the common string "-comp-1"
mutate_at("Sample Name", str_replace, "-comp-1", "") %>%
# separate the Sample Name into Site ID and plot info
separate(`Sample Name`, c("Site ID","subplot.layer.date"), "_", remove = FALSE,) %>%
# separate the plot info into 3 columns
separate(`subplot.layer.date`, c("Subplot", "Layer", "Date"), "-")
NEON_chemistry <- read_tsv("data/neon_plot_soilChem1_metadata.tsv") %>%
# remove -COMP from genomicsSampleID
mutate_at("genomicsSampleID", str_replace, "-COMP", "")
kable(
NEON_chemistry_description <- read_tsv("data/neon_soilChem1_metadata_descriptions.tsv")
)
band_members
band_instruments
band_members %>%
left_join(band_instruments, by = "name")
band_members %>%
right_join(band_instruments, by = "name")
band_members %>%
inner_join(band_instruments, by = "name")
band_members %>%
full_join(band_instruments, by = "name")
table1
table3
table1 %>%
left_join(table3, by = c("country", "year"))
band_members %>%
left_join(band_instruments2, by = c(name = "artist"))
table4a %>%
left_join(table4b, by = "country")
table4a %>%
left_join(table4b, by = "country", suffix = c("_cases", "_pop"))
NEON_MAGs_E1 <- NEON_MAGs %>%
select(`Sample Name`, `Site ID`, `GTDB-Tk Taxonomy Lineage` )
NEON_metagenomes_E1 <- NEON_metagenomes %>%
select(`Sample Name`, `Site ID`, `Ecosystem Subtype`)
NEON_chemistry_E1 <- NEON_chemistry %>%
select(genomicsSampleID, siteID, nlcdClass) %>%
rename('Site ID' = `siteID`)
NEON_MAGs_E2 <- NEON_MAGs_E1 %>%
filter(`Site ID`== "CLBJ")
NEON_metagenomes_E2 <- NEON_metagenomes_E1 %>%
filter(`Site ID`== "CLBJ")
NEON_chemistry_E2 <- NEON_chemistry_E1 %>%
filter(`Site ID`== "CLBJ")
NEON_MAGs_E2 %>%
left_join(NEON_metagenomes_E2, by = "Sample Name") %>%
datatable()
NEON_metagenomes_E2 %>%
left_join(NEON_MAGs_E2, by = "Sample Name") %>%
datatable()
NEON_metagenomes_E2 %>%
left_join(NEON_chemistry_E2, by = c(`Sample Name` = "genomicsSampleID")) %>%
datatable()
NEON_metagenomes_E2 %>%
right_join(NEON_chemistry_E2, by = c(`Sample Name` = "genomicsSampleID")) %>%
datatable()
NEON_metagenomes_E2 %>%
full_join(NEON_chemistry_E2, by = c(`Sample Name` = "genomicsSampleID")) %>%
datatable()
NEON_chemistry_E2 %>%
left_join(NEON_metagenomes_E2,by = c(`genomicsSampleID` = "Sample Name"), `Site ID`) %>%
datatable()
NEON_metagenomes_E2 %>%
left_join(NEON_chemistry_E2, by = c("Sample Name" = "genomicsSampleID")) %>%
datatable()
NEON_MAGs_E7 <- NEON_MAGs
NEON_metagenomes_E7 <- NEON_metagenomes
NEON_chemistry_E7 <- NEON_chemistry %>%
rename('Site ID' = `siteID`)
NEON_metas_and_chemistry <- NEON_metagenomes_E7 %>%
full_join(NEON_chemistry_E7,by = c(`Sample Name` = "genomicsSampleID"), `Site ID`)
NEON_data_all <- NEON_metas_and_chemistry %>%
full_join(NEON_MAGs_E7, by = "Sample Name")
NEON_data_full <- NEON_data_all %>%
select(-`Site ID.y`, -`Site.y`, -`Subplot.y`, -`Layer.y`, -`Date.y`, -`IMG Genome ID.y`) %>%
select(-`Site ID.x`) %>%
rename('Source of Sample' = `Domain.x`) %>%
rename('Site' = `Site.x`, 'Subplot' = `Subplot.x`, 'Layer' = `Layer.x`, 'Date' = `Date.x`, 'IMG Genome ID' = `IMG Genome ID.x`)
datatable(NEON_data_full)
NEON_E8 <- NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Site != "NEON combined assembly")
NEON_E8 %>%
ggplot(aes(x = soilTemp, y= `Site ID`)) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Soil Temperature of Actinibacteriota Samples by Site", x = "Soil Temperature", y = "Site ID") +
theme(axis.text.x = element_text(size = 12, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = .5))+
coord_flip()
NEON_E9 <- NEON_data_full %>%
filter(Phylum == "Actinomycetota")
NEON_E9 %>%
ggplot(aes(x = soilTemp, y= `Ecosystem Subtype`)) +
geom_point(aes(color=Order)) +
labs(title = "Soil Temperature of Actinibacteriota Samples by Ecosystem Subtype, Colored by Order", x = "Soil Temperature", y = "Ecosystem Subtype") +
theme(axis.text.x = element_text(size = 12, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 0))+
coord_flip()
NEON_E10 <- NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(nlcdClass != "NA")
NEON_E10 %>%
ggplot(aes(x =  soilInCaClpH, y= `nlcdClass`)) +
geom_point(aes(color=Family)) +
labs(title = "Actinobacteriota Soil Calcium Chloride pH by NLCD Classification, Colored by Family ", x = "Soil Calcium Chloride pH", y = "National Land Cover Database") +
theme(axis.text.x = element_text(size = 12, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 0),legend.title = element_text(size = 12),
legend.text = element_text(size = 10))+
coord_flip()
NEON_E11 <- NEON_data_full %>%
filter(Phylum == "Actinomycetota")
NEON_E11 %>%
ggplot(aes(x =  `elevation`, y= `Site ID`)) +
geom_point(aes(color=Class)) +
labs(title = "Actinobacteriota Elevation by Site, Colored by Class", x = "Elevation", y = "Site ID") +
theme(axis.text.x = element_text(size = 12, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 0),legend.title = element_text(size = 12),
legend.text = element_text(size = 10))+
coord_flip()
NEON_E12 <- NEON_data_full %>%
filter(Phylum == "Actinomycetota")
NEON_E12 %>%
ggplot(aes(x =  `elevation`, y= `soilTemp`)) +
geom_point(aes(color=Site, shape=Class)) +
labs(title = "Elevation and Temperature for Actinobacteriota Samples ", x = "Elevation", y = "Soil Temperature") +
theme(axis.text.x = element_text(size = 12, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 0),legend.title = element_text(size = 12),
legend.text = element_text(size = 10))+
coord_flip()
NEON_E13 <- NEON_data_full %>%
filter(Phylum == "Actinomycetota")
NEON_E13 %>%
ggplot(aes(x =  `nitrogenPercent`, y= `elevation`)) +
geom_point(aes(color=Site, shape=Class)) +
labs(title = "Nitrogen Percentage by Elevation for Actinobacteriota", x = "Nitrogen Percentage", y = "Elevation") +
theme(axis.text.x = element_text(size = 12, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 0),legend.title = element_text(size = 12),
legend.text = element_text(size = 10))+
coord_flip()
knitr::opts_chunk$set(echo = TRUE)
NEON_E9 <- NEON_data_full %>%
filter(Phylum == "Actinomycetota")
NEON_E9 %>%
ggplot(aes(x = soilTemp, y= `Ecosystem Subtype`)) +
geom_point(aes(color=Class)) +
labs(title = "Soil Temperature of Actinibacteriota Samples by Ecosystem Subtype, Colored by Order", x = "Soil Temperature", y = "Ecosystem Subtype") +
theme(axis.text.x = element_text(size = 12, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 0))+
coord_flip()
library(tidyverse)
library(plotly)
library(knitr)
library(DT)
library(readr)
Project_MAGs <- read.csv("Project_MAGs.csv")
Project_MAGs_LBJ <- Project_MAGs %>%
filter(Site == "National Grasslands LBJ, Texas, USA")
Project_MAGs_LBJ %>%
ggplot(aes(x = fct_rev(fct_infreq(Phylum)))) +
geom_bar(fill = "cyan4",color = "black") +
labs(title = "Phylum Counts for MAGs at National Grasslands LBJ, Texas, USA", x = "Phylum", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 15),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 2))+
coord_flip()
Project_MAGs_LBJ %>%
ggplot(aes(x = fct_rev(fct_infreq(Phylum)), fill = Class)) +
geom_bar() +
labs(title = "Phylum Counts for MAGs at National Grasslands LBJ, Texas, USA", x = "Phylum", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 15),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = .3))+
coord_flip()
Project_MAGs_LBJ %>%
ggplot(aes(x = fct_rev(fct_infreq(Class)))) +
geom_bar(fill = "cyan4", color = "black") +
labs(title = "Class Counts for MAGs at National Grasslands LBJ, Texas, USA", x = "Class", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = -2))+
coord_flip()
Project_MAGs_LBJ %>%
ggplot(aes(x= Total.Number.of.Bases)) +
labs(title = "Genome Size Analysis for MAGs at National Grasslands LBJ, Texas, USA", x = "Total Number of Bases", y = "Number of MAGs") +
geom_histogram(bins = 20, fill = "cyan4", color = "black") +
scale_x_continuous(breaks = seq(0, max(Project_MAGs_LBJ$Total.Number.of.Bases), by = 1000000)) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1))
datatable(Project_MAGs_LBJ)
Project_MAGs %>%
filter(Phylum == "Actinobacteriota") %>%
filter(Site != "NEON combined assembly") %>%
ggplot(aes(x = fct_rev(fct_infreq(Site)))) +
geom_bar(fill = "cyan4", color = "black") +
labs(title = "Abundance of Actinobacteriota at NEON Sites", x = "Site", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 1.5))+
coord_flip()
Project_MAGs %>%
filter(Phylum == "Actinobacteriota") %>%
filter(Site != "NEON combined assembly") %>%
ggplot(aes(x = fct_rev(fct_infreq(Site)), fill = Class)) +
geom_bar() +
labs(title = "Abundance of Actinobacteriota at NEON Sites", x = "Site", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 1.5))+
coord_flip()
Project_MAGs %>%
filter(Phylum == "Actinobacteriota") %>%
filter(Site != "NEON combined assembly") %>%
ggplot(aes(x = fct_rev(fct_infreq(Class)), fill = Site)) +
geom_bar() +
labs(title = "Sub Taxonomy of Actinobacteriota, Class (Colored by Site)", x = "Class", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 1.5))+
coord_flip()
Project_MAGs %>%
filter(Phylum == "Actinobacteriota") %>%
filter(Site != "NEON combined assembly") %>%
ggplot(aes(x = fct_rev(fct_infreq(Order)), fill = Site)) +
geom_bar() +
labs(title = "Sub Taxonomy of Actinobacteriota, Order (Colored by Site)", x = "Order", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 1.5))+
coord_flip()
Project_MAGs %>%
filter(Phylum == "Actinobacteriota") %>%
filter(Site != "NEON combined assembly") %>%
ggplot(aes(x = fct_rev(fct_infreq(Family)), fill = Site)) +
geom_bar() +
labs(title = "Sub Taxonomy of Actinobacteriota, Family (Colored by Site)", x = "Family", y = "Number of MAGs") +
theme(axis.text.x = element_text(size = 15, angle = 0, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 17, hjust = 1.5))+
coord_flip()
Site_IMG <- read_tsv("data/exported_img_data.tsv")  #Loading TSV of IMG data for LBJ site
Site_IMG_annotated <- Site_IMG %>%
filter(grepl("re-annotation", `Genome Name / Sample Name`))
datatable(Site_IMG_annotated)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20, fill = "cyan4", color = "black") +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp ), fill=Class) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp ), fill = Class) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp ), fill = Order) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1))
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Phylu, != "NA")
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "A", x = "B", y = "C") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 3)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "n", y = "Soil Temperature") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 3)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "n", y = "Soil Temperature") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1)) +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "n", y = "Soil Temperature") +
geom_histogram(bins = 20) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1), legend.position = "bottom") +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "n", y = "Soil Temperature") +
geom_histogram(bins = 25) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1), legend.position = "bottom") +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "n", y = "Soil Temperature") +
geom_histogram(bins = 15) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1), legend.position = "bottom") +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "Soil Temperature", y = "n") +
geom_histogram(bins = 15) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1), legend.position = "bottom") +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "Soil Temperature", y = "Number of MAGs") +
geom_histogram(bins = 15) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1), legend.position = "bottom") +
facet_wrap(vars(Class), scales = "free", ncol = 2)
NEON_data_full %>%
filter(Phylum == "Actinomycetota") %>%
filter(Class != "NA") %>%
ggplot(aes(x=soilTemp, fill=Class )) +
labs(title = "Soil Temperatuer of Actinomycetota, Faceted by Class", x = "Soil Temperature", y = "Number of MAGs") +
geom_histogram(bins = 25) +
theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size = 12),
text = element_text(size = 15), plot.title = element_text(size = 15, hjust = 1), legend.position = "bottom") +
facet_wrap(vars(Class), scales = "free", ncol = 2)
